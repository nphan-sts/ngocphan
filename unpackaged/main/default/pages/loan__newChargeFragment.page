<apex:page lightningStylesheets="true" standardController="loan__Loan_Account__c" extensions="loan.ChargeFragmentController" 
                tabStyle="loan__Loan_Account__c" sidebar="{!IF($CurrentPage.Parameters.modal == 'true', false, true)}" >
<apex:include pageName="clcommon__mintTheme"/>

    
    <script src="{!URLFOR($Resource.loan__jQueryFiles, 'js/jquery-1.8.3.min.js')}"/>
    <script src="{!URLFOR($Resource.loan__helperclose)}"/>
    <script> function setFocusOnLoad(){} </script>
    <script>
        j$ = jQuery.noConflict();
    </script>
    <apex:stylesheet value="{!IF($CurrentPage.Parameters.modal == 'true', $Resource.loan__modalheaderStyle,'')}"/>
    <apex:form id="chargeForm">     
        <apex:pageblock mode="edit" id="topBlk">
            <apex:inlineEditSupport />
            <apex:pageBlockButtons location="bottom" >
                <c:BusyButton name="Save" busyName="Saving" actionTo="{!save}"
                    reRenderTo="chargeForm"
                    oncomplete="({!closeModal}===true) ? closeFragment() : {};"
                    id="sBtn"/>
                <c:BusyButton name="Save & New" busyName="Saving" actionTo="{!save}"
                    reRenderTo="chargeForm"
                    oncomplete="closeFragmentNoSlide()"
                    id="snBtn"/>
                <apex:commandButton value="Cancel" reRender="dummy" 
                            immediate="true"
                            onclick="closeFragment()" 
                            id="cBtn"/>
            </apex:pageBlockButtons>
            <apex:pageMessages />
            <apex:outputPanel styleClass="mint-lightning-wrapper">
            <apex:pageBlockSection columns="2" title="Information">
                <apex:pageBlockSectionItem >
                    <apex:outputLabel >Loan</apex:outputLabel>
                    <apex:outputpanel >
                        <apex:outputfield value="{!charge.loan__Loan_Account__c}" >                            
                            <apex:inlineEditSupport disabled="true"/>
                        </apex:outputField>
                    </apex:outputpanel>
                </apex:pageBlockSectionItem>
                <apex:inputField value="{!charge.loan__Date__c}"/>
                <apex:pageBlocksectionItem >
                    <apex:outputLabel >Fee</apex:outputLabel>
                    <apex:outputPanel >
                        <apex:inputField value="{!charge.loan__Fee__c}">
                            <apex:actionsupport action="{!feeChanged}" event="onchange" reRender="topBlk" status="feeChange"/>
                        </apex:inputField>
                        <apex:actionStatus id="feeChange">
                            <apex:facet name="start" >
                                <apex:image value="/img/loading32.gif" style="height:15px;"/>
                            </apex:facet>
                        </apex:actionStatus>
                    </apex:outputPanel>
                </apex:pageBlocksectionItem>
            </apex:pageBlockSection>
            </apex:outputPanel>
            <apex:pageBlockSection columns="1">
                <apex:inputField value="{!charge.loan__Reference__c}"/>
            </apex:pageBlockSection>
            <apex:outputPanel styleClass="mint-lightning-wrapper">
            <apex:pageBlockSection columns="2" title="Interest & Amount">
                <apex:inputCheckbox value="{!charge.loan__Interest_Bearing__c}"/>
                <apex:inputField value="{!charge.loan__Interest_Rate__c}"/>
                <apex:inputField value="{!charge.loan__Accrue_Interest_From__c}"/>
                <apex:inputField value="{!charge.loan__Original_Amount__c}"/>
            </apex:pageBlockSection>
            </apex:outputPanel>
        </apex:pageblock>
    </apex:form>
</apex:page>