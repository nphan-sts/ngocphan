@RestResource(urlMapping='/application/date/*')
global with sharing class MW_RetrieveAccountsByDate {
    @HttpGet
    global static void MW_RetrieveAccountsByDate() {
        RestRequest req = RestContext.request;
        RestResponse res = RestContext.response;
        try {
            String originationDate = req.params.get('origination-date');
            if (String.isBlank(originationDate)) {
                res.statusCode = 400;
                res.responseBody = Blob.valueOf('date is required');
                return;
            }
            Date formatted = Date.valueOf(originationDate);

            List<genesis__applications__c> apps = [
                SELECT
                Id,
                OwnerId,
                Name,
                RecordTypeId,
                CreatedDate,
                CreatedById,
                LastModifiedDate,
                LastModifiedById,
                genesis__APR__c,
                genesis__Account__c,
                genesis__Action__c,
                genesis__Additional_Cash_Required__c,
                genesis__Amortization_Term__c,
                genesis__Arrears__c,
                genesis__Asset_Class__c,
                genesis__Asset_Liability_Info__c,
                genesis__Assigned_To__c,
                genesis__Auto_Decisioning__c,
                genesis__Balloon_Payment__c,
                genesis__Bank_Account_Number__c,
                genesis__Bank_Account_Type__c,
                genesis__Bank_Name__c,
                genesis__Bank_Transactions_Fetched__c,
                genesis__CL_Company__c,
                genesis__CL_Product_Name__c,
                genesis__CL_Product__c,
                genesis__CL_Purpose__c,
                genesis__Call_Code__c,
                genesis__Cap_Reduction__c,
                genesis__Cash_Collected_By_Dealer__c,
                genesis__Charge_offs__c,
                genesis__Class_Code__c,
                genesis__Collateral_Type__c,
                genesis__Collateral_Value__c,
                genesis__Company__c,
                genesis__Contact__c,
                genesis__Credit_Limit__c,
                genesis__Credit_Rating__c,
                genesis__Customer_Cash_Available__c,
                genesis__Customer_Cash_Used_For__c,
                genesis__Days_Convention__c,
                genesis__Dealer_Payment_Date__c,
                genesis__Description__c,
                genesis__Disbursement_Date__c,
                genesis__Discount_Rate_Based_On__c,
                genesis__Discount_Rate__c,
                genesis__Documentation_Charges__c,
                genesis__Down_Payment__c,
                genesis__Draw_Period_End_Date__c,
                genesis__Draw_Term__c,
                genesis__Employee_Loan__c,
                genesis__Estimated_Selling_Price__c,
                genesis__Expected_Close_Date__c,
                genesis__Expected_First_Payment_Date__c,
                genesis__Expected_Start_Date__c,
                genesis__Fees_Amount__c,
                genesis__Financed_Amount__c,
                genesis__Funding_in_Tranches__c,
                genesis__Gross_Annual_Income__c,
                genesis__Healthcare_Procedure__c,
                genesis__ID_Number__c,
                genesis__ID_State__c,
                genesis__ID_Type__c,
                genesis__Initial_Advance__c,
                genesis__Interest_Calculation_Method__c,
                genesis__Interest_Only_Period__c,
                genesis__Interest_Rate__c,
                genesis__Is_over_21__c,
                genesis__LTV_Pledged_Collateral__c,
                genesis__Landing_Sequence__c,
                genesis__Lending_Product__c,
                genesis__Loan_Amount__c,
                genesis__Loan_Number__c,
                genesis__Margin__c,
                genesis__Maturity_Date__c,
                genesis__Maximum_Loan_Amount_DTI__c,
                genesis__Minimum_Cash_Required__c,
                genesis__Monthly_Debt_Payments__c,
                genesis__Monthly_Income_Expense_Info__c,
                genesis__Net_Present_Value__c,
                genesis__No_Of_Payments_Required_Upfront__c,
                genesis__Number_of_Pieces_of_Equipment__c,
                genesis__Other_Financed_fees__c,
                genesis__Overall_Status__c,
                genesis__Parent_Application__c,
                genesis__Participation_Date__c,
                genesis__Payable_To_Dealer__c,
                genesis__Payment_Amount__c,
                genesis__Payment_Due_Date__c,
                genesis__Payment_Frequency_Multiplier__c,
                genesis__Payment_Frequency__c,
                genesis__Portfolio__c,
                genesis__Prepaid_Interest_Option__c,
                genesis__Prepayment_Penalty_Description__c,
                genesis__Prepayment_Penalty__c,
                genesis__Pricing_Method__c,
                genesis__Primary_Collateral_Code__c,
                genesis__Primary_Property_Address__c,
                genesis__Primary_Source_of_Repayment__c,
                genesis__Probability__c,
                genesis__Product_Sub_Type__c,
                genesis__Product_Type__c,
                genesis__Quick_Quote__c,
                genesis__Rate_Ceiling__c,
                genesis__Rate_Discount__c,
                genesis__Rate_Floor__c,
                genesis__Regulation_O__c,
                genesis__Required_Customer_Cash__c,
                genesis__Residual_Amount__c,
                genesis__Retained_Amount__c,
                genesis__Routing_Number__c,
                genesis__Sales_Division__c,
                genesis__Secondary_Source_of_Repayment__c,
                genesis__Spread__c,
                genesis__Status__c,
                genesis__Sublimit_Variance__c,
                genesis__Tax_Amount__c,
                genesis__Term__c,
                genesis__Terms_Selected__c,
                genesis__Total_Cash_Due_from_Customer__c,
                genesis__Total_Dealer_Payable__c,
                genesis__Total_Dealer_Price__c,
                genesis__Total_Estimated_Interest__c,
                genesis__Total_Facilities__c,
                genesis__Total_Facility_Amount__c,
                genesis__Total_Facility_Variance__c,
                genesis__Total_Fee_Amount__c,
                genesis__Total_Pledged_Collateral_Amount__c,
                genesis__Total_Upfront_Payments__c,
                genesis__Valid_Pricing_Flag__c,
                genesis__Warranty_Amount__c,
                genesis__Yield__c,
                genesis__SubLimit_Total__c,
                genesis__Total_Score__c,
                genesis__Calculation_Action__c,
                genesis__Due_Day__c,
                genesis__Expected_Second_Pay_Day_Date__c,
                genesis__Interest_Compounding_Frequency__c,
                genesis__Is_Get_Yield_Enabled__c,
                genesis__Payment_Amount_Step_Up_Type__c,
                genesis__Repayment_Procedure__c,
                genesis__Subvention_Amount__c,
                genesis__Subvention_Percent__c,
                ALertFlag__c,
                Accepted__c,
                Affiliate_Partner__c,
                Alerts_No_Of_Days_Before_Expiration__c,
                Anniversary_Date__c,
                Applicant_Name__c,
                ApplicationTemplate__c,
                Application_Email__c,
                Application_Graph__c,
                Application_SessionId__c,
                Application_Start_DateV2__c,
                Application_Start_Date__c,
                Application_Work_Email__c,
                Application_external_id__c,
                Bank_Account__c,
                Bank_Verification_Flag__c,
                Borrower_s_Email__c,
                Borrower_s_First_Name__c,
                Borrower_s_LastName__c,
                Borrowers_Work_Email__c,
                BoxFolderID__c,
                Bureau_SSN_Masked__c,
                Bureau_SSN__c,
                CL_Contract__c,
                CheckEmailAlertValue__c,
                Conga_Solution_Template_Inv_Harsh__c,
                CreditScore_Notice__c,
                Credit_Policy_Verification_Flag__c,
                Credit_Summary_Verification__c,
                Decline_Reason__c,
                Differenc_Between_Today_and_Expiry_Date__c,
                DocuSignFlag__c,
                DocuSign_EnvelopeId__c,
                DocuSign_Envelope_ID__c,
                DocuSign_Envelope_Status__c,
                DocuSign_Sign_Date__c,
                Employer__c,
                Employment_Status__c,
                Estimated_Amount_needed__c,
                Estimated_credit_card_balances__c,
                Estimated_loan_balances__c,
                Estimated_origination_fee__c,
                Expiration_Date__c,
                Expiration_Date_for_Email_trigger__c,
                Expiration_Tag__c,
                Expiry_Date__c,
                File_cleared_Image__c,
                File_rejected_image__c,
                File_submitted_image__c,
                File_total_image__c,
                Fraud_Assignment_Reason__c,
                GIACTPerformed_By__c,
                GIACT_Date__c,
                GIACT_Status__c,
                IV_Performed_By__c,
                IV_Performed_Date__c,
                Income_Verification_Flag__c,
                Initial_Term_Payment_Amt__c,
                Invested_Amount__c,
                InvestorAddress__c,
                Investor_Selected__c,
                Investor__c,
                Iovation_Score__c,
                Iovation_Status__c,
                KBAV_Performed_BY__c,
                KBAV_Performed_Date__c,
                KBA_Verification__c,
                Last_Investor_Assigned_On__c,
                Last_Payment_Amount__c,
                LeadGUIDBoxFolderID__c,
                LeadGUID_XX_BoxFolderID__c,
                Lead_ID__c,
                Lead_Source__c,
                Loan_Doc_Signed_On__c,
                Loan_Maturity_Date__c,
                Loan_Origination_Date__c,
                Loan_Premium_Amount__c,
                Loan_Premium_Price__c,
                Loan_Term_sub_1__c,
                Manual_Soft_Pull__c,
                Memberaddress__c,
                NeoV_Performed_By__c,
                NeoV_Performed_Date__c,
                Neo_Verification__c,
                Neo_Verify__c,
                Neoverify_Application_Date__c,
                Neoverify_Report_Id__c,
                NetTotalStatedIncome__c,
                Net_Difference_Net_Income__c,
                Net_Difference__c,
                Net_Variance__c,
                Neustart__c,
                NotifyCheck__c,
                OpenImage__c,
                Open__c,
                Origination_fee__c,
                Payment_Mode__c,
                Payoff_UID__c,
                Rejected__c,
                Rejection_Reason__c,
                Required_Docs_Count__c,
                Send_Offer_expiry_notification__c,
                Sift_Status__c,
                Sift_score__c,
                Stacker_Reviewed__c,
                Submitted__c,
                Summary_of_Revolving_Balances__c,
                Today_s_Date__c,
                TotalStatedIncome__c,
                Total_Uploaded__c,
                Total__c,
                Total_of_Payments__c,
                Total_required__c,
                Unmask_Bureau_SSN__c,
                Variance__c,
                Webhook_Docusign__c,
                What_you_get_Total_Amount_Offered__c,
                Withdraw_Reason__c,
                Work_Email__c,
                X14day_s_Before_Expiration_Date__c,
                YearForEmail__c,
                Yodlee_Transaction__c,
                agentVerificationPendingFlag__c,
                isRedecision__c,
                is_PB_running__c,
                First_time_offer_select__c,
                Identity_Counter__c,
                Net_Total_Calculated_Income__c,
                Net_Total_Stated_Income__c,
                Total_Calculated_Income__c,
                Total_Stated_Income__c,
                Esign_consent_withdrawn__c,
                Esign_consent_withdrawn_date__c,
                LEAD_ID_ExtKey__c,
                Manual_Adverse_Action_Decline__c,
                Member_ID__c,
                Number_of_days__c,
                Requested_loan_amount__c,
                isHardPull__c,
                isdefaultDocuments__c,
                statusWebhook__c,
                Bureau_DOB__c,
                SSNMatch__c,
                custom_APR_for_not_rounding__c,
                utm_campaign__c,
                utm_content__c,
                utm_medium__c,
                utm_offerCode__c,
                utm_source__c,
                Last_Interaction__c,
                YodleeBankAccount_Count__c,
                YodleeTxns_CheckingBalance__c,
                YodleeTxns_SavingsBalance__c,
                Fraud_Tag_Count__c,
                Fastpass_Score__c,
                Payoff_Loan_ID__c,
                maturityDate__c,
                OLN_Stacker_Status__c,
                TU_consumer_id__c,
                leadGuidEndingWith__c,
                Approver_user__c,
                Outbounder_user__c,
                Pre_checker_user__c,
                Processor_user__c,
                User_Approver__c,
                User_Outbounder__c,
                User_PreChecker__c,
                User_Processor__c,
                State__c,
                DCP_Investor_Eligibility__c,
                DCP_total_amount__c,
                DateTimeCurrentStatus__c,
                readyforverificationQueueFlag__c,
                Marketing_Offer__c,
                Unique_Count__c,
                FirstLetterOfGuid__c,
                CreditOptic_IdScore__c,
                RatioSalaryStatedIncome__c,
                TalxSalary__c,
                YodleeTxns_CheckingAvailBalance__c,
                YodleeTxns_SavingsAvailBalance__c,
                Loan_PremiumAmount__c,
                Loan_PremiumPrice__c,
                Verification_Segment__c,
                DCP_Mandatory_Flag__c,
                DCP_Mandatory_Threshold__c,
                DCP_Mandatory_Funding_Difference__c,
                DCP_Mandatory__c,
                DCP_Remainder_to_Member_Account__c,
                dcp_eligible__c,
                Application_Tag_Created_Date__c,
                First_Agent_Verified_Date__c,
                LeadGuid_Fifth_Character__c,
                LeadGuid_Sixth_Character__c,
                Member_Portal_2_0__c,
                GIACT_Link_Formula__c,
                Pricing_Tier__c,
                StartDate_Matches_CreatedDate__c,
                ManualKBApass_Performed_By__c,
                ManualKBApass_Performed_Date__c,
                Manual_KBA__c,
                DOB_Match__c,
                Verification_Complexity__c,
                DataArchiva_Read_Only_Data__c,
                DataArchiva_Old_Id__c
                FROM genesis__applications__c WHERE Loan_Origination_Date__c = :formatted
            ];

            res.statusCode = 200;
            res.responseBody = Blob.valueOf(JSON.serialize(apps));
        }
        catch (Exception e) {
            res.statusCode = 500;
            res.responseBody = Blob.valueOf(e.getMessage());
        }
        

    }
}
