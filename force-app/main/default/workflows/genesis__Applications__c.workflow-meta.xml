<?xml version="1.0" encoding="UTF-8"?>
<Workflow xmlns="http://soap.sforce.com/2006/04/metadata">
    <alerts>
        <fullName>Expiry_Alert</fullName>
        <description>Expiry Alert</description>
        <protected>false</protected>
        <recipients>
            <field>Borrower_s_Email__c</field>
            <type>email</type>
        </recipients>
        <senderAddress>verification@happymoney.com</senderAddress>
        <senderType>OrgWideEmailAddress</senderType>
        <template>Payoff_Email_Templates/Offer_Expiration_Application</template>
    </alerts>
    <alerts>
        <fullName>customer_service_pre_funding_liquid</fullName>
        <description>customer_service_pre_funding.liquid(Lead state = prefunding)</description>
        <protected>false</protected>
        <recipients>
            <field>Borrower_s_Email__c</field>
            <type>email</type>
        </recipients>
        <senderAddress>success@happymoney.com</senderAddress>
        <senderType>OrgWideEmailAddress</senderType>
        <template>Payoff_Email_Templates/customer_service_pre_funding</template>
    </alerts>
    <alerts>
        <fullName>e_sign_borrower_pending_Lead_state_agent_verified</fullName>
        <description>e_sign_borrower_pending(Lead state = agent verified)</description>
        <protected>false</protected>
        <recipients>
            <field>Borrower_s_Email__c</field>
            <type>email</type>
        </recipients>
        <senderAddress>verification@happymoney.com</senderAddress>
        <senderType>OrgWideEmailAddress</senderType>
        <template>Payoff_Email_Templates/e_sign_borrower_pending</template>
    </alerts>
    <alerts>
        <fullName>offer_expiration_14_days_liquid</fullName>
        <description>offer_expiration_14_days.liquid</description>
        <protected>false</protected>
        <recipients>
            <field>Borrower_s_Email__c</field>
            <type>email</type>
        </recipients>
        <senderAddress>verification@happymoney.com</senderAddress>
        <senderType>OrgWideEmailAddress</senderType>
        <template>Payoff_Email_Templates/Offer_Expiration_Application</template>
    </alerts>
    <fieldUpdates>
        <fullName>App_to_ADVP</fullName>
        <description>Move App status to ADVP</description>
        <field>genesis__Status__c</field>
        <literalValue>agent_document_verification_pending</literalValue>
        <name>App to ADVP</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Literal</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Approve_Applicaion</fullName>
        <field>genesis__Status__c</field>
        <literalValue>APPROVED - APPROVED</literalValue>
        <name>Approve Applicaion</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Literal</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Expire_Application</fullName>
        <field>Expiration_Date__c</field>
        <formula>$User.loan__Current_Branch_s_System_Date__c</formula>
        <name>Expire Application</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Formula</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Funding_Queue</fullName>
        <field>OwnerId</field>
        <lookupValue>Approval_Funding_Enrich</lookupValue>
        <lookupValueType>Queue</lookupValueType>
        <name>Funding Queue</name>
        <notifyAssignee>true</notifyAssignee>
        <operation>LookupValue</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>ReviewQueue</fullName>
        <description>changes OwnerID to Review Queue</description>
        <field>OwnerId</field>
        <lookupValue>Review_Queue</lookupValue>
        <lookupValueType>Queue</lookupValueType>
        <name>ReviewQueue</name>
        <notifyAssignee>true</notifyAssignee>
        <operation>LookupValue</operation>
        <protected>false</protected>
        <reevaluateOnChange>true</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Update_Borrower_Email_Id</fullName>
        <field>Borrower_s_Email__c</field>
        <formula>Application_Email__c</formula>
        <name>Update Borrower Email Id</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Formula</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Update_Borrower_Work_EmailId</fullName>
        <field>Borrowers_Work_Email__c</field>
        <formula>Work_Email__c</formula>
        <name>Update Borrower Work EmailId</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Formula</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Update_Performed_Date</fullName>
        <field>GIACT_Date__c</field>
        <formula>TODAY()</formula>
        <name>Update Performed Date</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Formula</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Update_Performer_Details</fullName>
        <description>Update Performed By and Date</description>
        <field>GIACTPerformed_By__c</field>
        <formula>$User.FirstName +&apos; &apos;+  $User.LastName</formula>
        <name>Update Performer Details</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Formula</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Update_Plaid_Performed_By</fullName>
        <field>Plaid_Performed_By__c</field>
        <formula>$User.FirstName +&apos; &apos;+ $User.LastName</formula>
        <name>Update Plaid Performed By</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Formula</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Update_Plaid_Performed_Date</fullName>
        <field>Plaid_Date__c</field>
        <formula>TODAY()</formula>
        <name>Update Plaid Performed Date</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Formula</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>assign_to_Verification_Queue</fullName>
        <field>OwnerId</field>
        <lookupValue>Verification_Queue</lookupValue>
        <lookupValueType>Queue</lookupValueType>
        <name>assign to Verification Queue</name>
        <notifyAssignee>true</notifyAssignee>
        <operation>LookupValue</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>move_back_to_MX_Queue</fullName>
        <description>move back to MX Queue</description>
        <field>OwnerId</field>
        <lookupValue>MX_Queue</lookupValue>
        <lookupValueType>Queue</lookupValueType>
        <name>move back to MX Queue</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>LookupValue</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <rules>
        <fullName>Avoid App Stuck In Offer Accepted</fullName>
        <actions>
            <name>App_to_ADVP</name>
            <type>FieldUpdate</type>
        </actions>
        <active>true</active>
        <criteriaItems>
            <field>genesis__Applications__c.genesis__Status__c</field>
            <operation>equals</operation>
            <value>offer_accepted</value>
        </criteriaItems>
        <criteriaItems>
            <field>genesis__Applications__c.Required_Docs_Count__c</field>
            <operation>equals</operation>
            <value>0</value>
        </criteriaItems>
        <triggerType>onCreateOrTriggeringUpdate</triggerType>
    </rules>
    <rules>
        <fullName>Esign Consent</fullName>
        <actions>
            <name>ReviewQueue</name>
            <type>FieldUpdate</type>
        </actions>
        <active>true</active>
        <criteriaItems>
            <field>genesis__Applications__c.Esign_consent_withdrawn__c</field>
            <operation>equals</operation>
            <value>True</value>
        </criteriaItems>
        <description>When Esign Consent Withdrawn is set to true, this rule sends application to Review Queue</description>
        <triggerType>onCreateOrTriggeringUpdate</triggerType>
    </rules>
    <rules>
        <fullName>Expire Application</fullName>
        <actions>
            <name>Expire_Application</name>
            <type>FieldUpdate</type>
        </actions>
        <active>true</active>
        <criteriaItems>
            <field>genesis__Applications__c.Expiration_Date__c</field>
            <operation>equals</operation>
        </criteriaItems>
        <triggerType>onCreateOrTriggeringUpdate</triggerType>
    </rules>
    <rules>
        <fullName>Expity Alert</fullName>
        <actions>
            <name>Expiry_Alert</name>
            <type>Alert</type>
        </actions>
        <active>true</active>
        <criteriaItems>
            <field>genesis__Applications__c.CheckEmailAlertValue__c</field>
            <operation>equals</operation>
        </criteriaItems>
        <description>/* Created By Nupur */</description>
        <triggerType>onCreateOrTriggeringUpdate</triggerType>
    </rules>
    <rules>
        <fullName>GIACT Update Details</fullName>
        <actions>
            <name>Update_Performed_Date</name>
            <type>FieldUpdate</type>
        </actions>
        <actions>
            <name>Update_Performer_Details</name>
            <type>FieldUpdate</type>
        </actions>
        <active>true</active>
        <description>Update PerformedBy and Date</description>
        <formula>ISCHANGED(GIACT_Status__c)</formula>
        <triggerType>onAllChanges</triggerType>
    </rules>
    <rules>
        <fullName>PLAID Status Update</fullName>
        <actions>
            <name>Update_Plaid_Performed_By</name>
            <type>FieldUpdate</type>
        </actions>
        <actions>
            <name>Update_Plaid_Performed_Date</name>
            <type>FieldUpdate</type>
        </actions>
        <active>true</active>
        <description>Update Plaid Performed By and Performed Date</description>
        <formula>ISCHANGED( Plaid_Status__c )</formula>
        <triggerType>onAllChanges</triggerType>
    </rules>
    <rules>
        <fullName>Update Borrower Email Id</fullName>
        <actions>
            <name>Update_Borrower_Email_Id</name>
            <type>FieldUpdate</type>
        </actions>
        <active>true</active>
        <formula>OR (      (AND(! ISBLANK(Application_Email__c),             ISBLANK(Borrower_s_Email__c ))) ,      (AND(! ISBLANK(Application_Email__c),           ! ISBLANK(Borrower_s_Email__c ),           !(Application_Email__c == Borrower_s_Email__c)))     )</formula>
        <triggerType>onAllChanges</triggerType>
    </rules>
    <rules>
        <fullName>Update Borrower Work EmailId</fullName>
        <actions>
            <name>Update_Borrower_Work_EmailId</name>
            <type>FieldUpdate</type>
        </actions>
        <active>true</active>
        <description>Update from Work Email formula field</description>
        <formula>OR (  (AND(! ISBLANK(Work_Email__c),  ISBLANK(Borrowers_Work_Email__c))) ,  (AND(! ISBLANK(Work_Email__c),  ! ISBLANK(Borrowers_Work_Email__c),  !(Work_Email__c == Borrowers_Work_Email__c)))  )</formula>
        <triggerType>onAllChanges</triggerType>
    </rules>
    <rules>
        <fullName>customer_service_pre_funding%2Eliquid%28Lead state %3D prefunding%29</fullName>
        <actions>
            <name>customer_service_pre_funding_liquid</name>
            <type>Alert</type>
        </actions>
        <active>true</active>
        <criteriaItems>
            <field>genesis__Applications__c.genesis__Status__c</field>
            <operation>equals</operation>
            <value>pre_funding</value>
        </criteriaItems>
        <description>/*Created By Nupur */
Your Payoff Loan is on the way!</description>
        <triggerType>onCreateOrTriggeringUpdate</triggerType>
    </rules>
    <rules>
        <fullName>e_sign_borrower_pending%28Lead state %3D agent verified%29</fullName>
        <actions>
            <name>e_sign_borrower_pending_Lead_state_agent_verified</name>
            <type>Alert</type>
        </actions>
        <active>true</active>
        <criteriaItems>
            <field>genesis__Applications__c.genesis__Status__c</field>
            <operation>equals</operation>
            <value>agent_verified</value>
        </criteriaItems>
        <criteriaItems>
            <field>genesis__Applications__c.DocuSignFlag__c</field>
            <operation>equals</operation>
            <value>True</value>
        </criteriaItems>
        <description>/* Created By Nupur */
------- Action Required - Please eSign your documents</description>
        <triggerType>onCreateOrTriggeringUpdate</triggerType>
    </rules>
    <rules>
        <fullName>offer_expiration_14_days%2Eliquid</fullName>
        <actions>
            <name>offer_expiration_14_days_liquid</name>
            <type>Alert</type>
        </actions>
        <active>true</active>
        <criteriaItems>
            <field>genesis__Applications__c.X14day_s_Before_Expiration_Date__c</field>
            <operation>equals</operation>
            <value>True</value>
        </criteriaItems>
        <criteriaItems>
            <field>genesis__Applications__c.genesis__Status__c</field>
            <operation>notEqual</operation>
            <value>REJECTED,funded,Declined,Withdrawn,Decline_Manual_Review</value>
        </criteriaItems>
        <criteriaItems>
            <field>genesis__Applications__c.Send_Offer_expiry_notification__c</field>
            <operation>equals</operation>
            <value>True</value>
        </criteriaItems>
        <description>Take advantage of your Payoff Loan offer</description>
        <triggerType>onCreateOrTriggeringUpdate</triggerType>
    </rules>
</Workflow>
